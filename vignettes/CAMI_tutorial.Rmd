---
title: "CAMI tutorial"
author: "Megan Ruffley"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{CAMI tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
## Community Assembly Model Inference

#### Installation
This tutorial shows one how to install the CAMI package, simualte community assembly data, and perform cross validation of model selection using random forest and approximate bayesian computation (ABC).

We will begin by installing **devtools**. Devtools is an R package that enables the development of other R packages. You can use devtools to install a package that is managed in a github repository. We will install CAMI this way. 

```{r message=FALSE}
install.packages("devtools")
require(devtools)
devtools::install_github("ruffleymr/CAMI")
require("CAMI")

```

#### Simulation of Data

We will simulate the community assembly data using the function _SimCommunityAssembly_. The function first simulates a regional community phylogeny and traits on that phylogeny. Then, using that information, the local community is assembled by either neutral, habitat filtering, or compeitive exclusion processes. 

Before we simulate data, let's go through the parameters of the function.

-**sims** indicates the number of communities to simulate. No default.
-**N** is the number of species in the regional community. No default.
-**local** is the size of the local community, this parameter can be an integer or a proportion. If a proporiton, then the size of the local community will be **N** * **local**. No default.
-**traitsim** indicates the model of trait evolution to use when simulating traits on the local phylogeny, can be either "BM" (default) for Brownian Motion or "OU" for Ornstein-Uhlenbeck.
-**comsim** indicates the community assembly model to simulate under, either "netural" (default), "filtering", "competition".
-**lambda** is the speciate rate of the birth death process used to simulate the regional phylogeny. It can be single number or prior range, the default is a uniform distribution between 0.05 and 2.0.
-**eps** is the extinction fraction, where extinction (_mu_) = **lambda** * **eps**. The default is a uniform prior distribution between 0.2 and 0.8.
-**sig2** is rate of character change, this can be single value or prior range. The defualt is a unifom prior distribution between 1.0 and 10.0.
-**alpha** is the pull to trait optimum, only used when simulate "OU" trait evolution models. The defualt is a uniform prior distribution between 0.01 and 0.2.
-**tau** is the stregnth of the community assembly model under "filtering" and "competition". The default is a uniform prior distribution between 5.0 and 5.0.

Now we can start simulating data. We will first simulate 1000 communites, where each communities has 100 species in the regional community, half the amount of species in the local community, a "BM" model of trait evolution, and a "neutral" model of community assembly. We will leave all other parameters with the default priors.

```{r}
Neutral.Sims <- SimCommunityAssembly(sims=1000, N=100, local=.5,
                                 traitsim="BM",
                                 comsim="neutral")

```

```{r}
Filtering.Sims <- SimCommunityAssembly(sims=1000, N=100, local=.5,
                                 traitsim="BM",
                                 comsim="filtering")

```

```{r}
Competition.Sims <- SimCommunityAssembly(sims=1000, N=100, local=.5,
                                 traitsim="BM",
                                 comsim="competition")

```



## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
